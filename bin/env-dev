#!/bin/sh

set -ue

if [ $# -lt 1 ]; then
	echo "Usage: base_dir [shell_init_cmd]" 1>&2
	exit 1
fi

base_dir="$1"
if [ $# -eq 2 ]; then
	term_cmd="qterminal -e '$2'"
else
	term_cmd="qterminal"
fi

mkdir -p "$1"
cd "$1"

i3-msg 'split vertical'
$term_cmd &
sleep 1
i3-msg 'title_format source'

$term_cmd &
sleep 1
i3-msg 'title_format tests'

i3-msg 'resize shrink up; resize shrink up'

i3-msg 'split horizontal'
$term_cmd &
sleep 1
i3-msg 'title_format repl'

i3-msg 'move right; split vertical'

i3-msg 'resize shrink left; resize shrink left'
i3-msg 'focus left; focus up'
